- name: Build ConfigMap data from env directory
  when: app.configmaps is defined
  block:

    - set_fact:
        configmap_data: {}

    - set_fact:
        configmap_data: "{{ configmap_data | combine({ (p | basename): lookup('file', p) }) }}"
      loop: "{{ lookup('fileglob', app_dir ~ '/proxy/configmap/' ~ target_env ~ '/*', wantlist=True) }}"
      loop_control:
        loop_var: p
